---
interface Props {
  scale?: number;
  top?: string;
  left?: string;
  right?: string;
  rotate?: number;
  opacity?: number;
  flip?: boolean;
}

const { scale = 0.8, top = '160px', left, right, rotate = 0, opacity = 1, flip = false } = Astro.props;

const styles = [
  `transform: scale(${flip ? -scale : scale}, ${scale}) rotate(${rotate}deg)`,
  `top: ${top}`,
  left !== undefined && `left: ${left}`,
  right !== undefined && `right: ${right}`,
  `opacity: ${opacity}`,
].filter(Boolean).join('; ');

const rand = (min: number, max: number) => Math.round((min + Math.random() * (max - min)) * 10) / 10;

// Each circle gets its own random drift waypoints, duration, and delay
const circles = [
  { t: 40, l: 230, bg: 'rgba(255,255,255,0.5)' },
  { t: 40, l: 0,   bg: 'rgba(255,255,255,0.5)' },
  { t: 0,  l: 60,  bg: 'rgba(255,255,255,0.7)' },
  { t: 80, l: 60,  bg: 'rgba(255,255,255,0.7)' },
  { t: 0,  l: 150, bg: 'rgba(255,255,255,0.6)' },
  { t: 80, l: 150, bg: 'rgba(255,255,255,0.7)' },
].map(c => ({
  ...c,
  duration: rand(12, 22),
  delay: -rand(0, 15),
  dx1: rand(-10, 10), dy1: rand(-8, 8),
  dx2: rand(-10, 10), dy2: rand(-8, 8),
  dx3: rand(-10, 10), dy3: rand(-8, 8),
}));
---

<div class="absolute" style={styles}>
  {circles.map(c => (
    <div
      class="circle-drift absolute w-[120px] h-[120px] rounded-full border border-[rgba(8,95,233,0.15)]"
      style={`top: ${c.t}px; left: ${c.l}px; background: ${c.bg}; --dx1: ${c.dx1}px; --dy1: ${c.dy1}px; --dx2: ${c.dx2}px; --dy2: ${c.dy2}px; --dx3: ${c.dx3}px; --dy3: ${c.dy3}px; animation-duration: ${c.duration}s; animation-delay: ${c.delay}s;`}
    />
  ))}
</div>

<style>
  @keyframes circle-drift {
    0%   { transform: translate(0, 0); }
    25%  { transform: translate(var(--dx1), var(--dy1)); }
    50%  { transform: translate(var(--dx2), var(--dy2)); }
    75%  { transform: translate(var(--dx3), var(--dy3)); }
    100% { transform: translate(0, 0); }
  }

  .circle-drift {
    animation: circle-drift ease-in-out infinite;
  }
</style>
